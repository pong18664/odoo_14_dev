<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="report_tax_invoice_version_th_custom">

        <!-- ส่วนหัว -->
        <div class="header" style="font-size:14px;">
            <!-- เพิ่มการอ้างอิงไฟล์ CSS -->
            <link rel="stylesheet" href="/navakij_report/static/src/css/tax_invoice_delivery_style_th.css"/>            

            <!-- class row -->
            <div class="row" style="width:100%; margin-left:0px;">

                <div class="col-2" style="padding-top:10px;">
                    <img style="width:100%;" t-att-src="image_data_uri(o.company_id.logo)" />
                </div>

                <div class="col-8" style="text-align:center; padding-top:10px;">
                    <b style="font-size:24px;" t-field="o.company_id.name"/>
                    <br/>
                    <b style="font-size:22px;" t-field="o.company_id.name_company_eng"/>
                    <br/>
                </div>

                <div class="col-2">
                    <div style="text-align:right; margin-right:2px;">
                        <span style="font-size:14;">หน้า                            
                            <span style="margin-left:5px" class="page" />
                            <span style="margin-left:5px"> ของ </span>
                            <span style="margin-left:5px" class="topage" />
                            <br/>
                        </span>
                    </div>
                    <div>
                        <t t-if="o.company_id.image">
                            <img style="width:100%;" t-att-src="image_data_uri(o.company_id.image)" />
                        </t>
                    </div>
                </div>

            </div>

            <!-- class address_company ที่อยู่บริษัท -->
            <div class="address_company" style="text-align:center; font-size:14;">
                <span t-field="o.company_id.street"/>
                <span t-field="o.company_id.zip"/>
                <br/>
                <span t-field="o.company_id.street_eng"/>
                <span t-field="o.company_id.zip"/>
                <br/>
                <span>โทร<span style="margin-left:5px;" t-field="o.company_id.phone"/>
                <span t-field="o.company_id.email"/>
                เลขประจำตัวผู้เสียภาษี<span style="margin-left:5px;" t-field="o.company_id.vat"/>
                </span>
                <br/>
                <span>Tel.<span style="margin-left:5px;" t-field="o.company_id.phone"/>
                <span t-field="o.company_id.email"/>
                TAX ID.<span style="margin-left:5px;" t-field="o.company_id.vat"/>
                </span>
                <br/>
                <br/>
                <b style="font-size:20px;">ใบกำกับภาษี/ใบส่งของ</b>
            </div>

            <!-- class row -->
            <div class="row" style="width:100%; margin-left:0px;">
                <!-- col ที่ 1 -->
                <div class="col-8" style="padding-top:45px; padding-left:3px;">
                    
                </div>
                <!-- col ที่ 2 -->
                <div class="col-2" style="border:1px solid; padding-left:0px; padding-right:0px; text-align:right; ">
                    <div class="col-12" style=" padding-top:4px; padding-bottom:5px; padding-right:3px; border-bottom:1px solid; ">
                        <span >
                            <b>เลขที่เอกสาร</b>
                        </span>
                    </div>
                    <div class="col-12" style=" padding-top:4px; padding-bottom:5px; padding-right:3px; ">
                        <span >
                            <b>วันที่เอกสาร</b>
                        </span>
                    </div>
                </div>
                <!-- col ที่ 3 -->
                <div class="col-2" style="border:1px solid; padding-left:0px; padding-right:0px; text-align:left;">
                    <div class="col-12" style="padding-top:5px; padding-bottom:5px; padding-left:3px; border-bottom:1px solid;">
                        <t t-if="o.select_tax_invoice_id.tax_invoice_number">
                            <span t-field="o.select_tax_invoice_id.tax_invoice_number"/>
                        </t>
                        <t t-else="">
                            <span style="color:white;">.</span>
                        </t>
                    </div>
                    <div class="col-12" style="padding-top:5px; padding-bottom:5px; padding-left:3px;">
                        <t t-if="o.select_tax_invoice_id.tax_invoice_date">
                            <span t-esc="o.get_formatted_date(o.select_tax_invoice_id.tax_invoice_date)"/>
                        </t>
                        <t t-else="">
                            <span style="color:white;">.</span>
                        </t>
                    </div>
                </div>
            </div> 

            <!-- table-left and table-right -->
            <div class="row" style="width:870px; margin-left:0px; margin-top:2px;">
                <div class="div-left">
                    <table class="table-left">
                        <t t-set="partner_name" t-value="o.partner_id.name.split('สาขาที่')"/>
                        <tbody>
                            <tr>
                                <td><b>ชื่อลูกค้า</b></td>
                                <td rowspan="2">
                                    <t t-if="o.partner_id.parent_id">
                                        <span t-esc="partner_name[0]"/>
                                    </t>
                                    <t t-else="">
                                        <span t-field="o.partner_id.name"/>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td><span style="color:white;">.</span></td>
                            </tr>
                            <tr>
                                <td><b>สาขา</b></td>
                                <td>
                                    <t t-if="o.partner_id.parent_id">
                                        <span>สาขาที่ <span t-esc="partner_name[1]"/></span>
                                    </t>
                                    <t t-else="">
                                        <t t-if="o.partner_id.company_type == 'company'">
                                            <span>สำนักงานใหญ่</span>
                                        </t> 
                                        <t t-else="">
                                            <span></span>
                                        </t>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <b>เลขประจำตัวผู้เสียภาษี</b>
                                    <span style="margin-left:4px;" t-field="o.partner_id.vat"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <b>ที่อยู่</b>
                                    <span style="margin-left:4px;" t-field="o.partner_id.street"/>
                                    <span t-field="o.partner_id.street2"/>
                                    <span t-field="o.partner_id.city"/>
                                    <span t-field="o.partner_id.state_id.name"/>
                                    <span t-field="o.partner_id.zip"/>                           
                                </td>
                            </tr>
                            <tr>
                                <td><span style="color:white;">.</span></td>
                            </tr>
                            <tr>
                                <td><b>โทร</b></td>
                                <td>
                                    <t t-if="o.partner_id.phone">
                                        <span t-esc="o.partner_id.phone.replace('+66 ','0')"/>
                                    </t>
                                    <t t-else="">
                                        <span>-</span>
                                    </t>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="div-right">
                    <table class="table-right">
                        <tbody>
                            <tr>
                                <td><b>รหัสโครงการ</b></td>
                                <td rowspan="2"><span t-field="o.analytic_account_id"/></td>
                            </tr>
                            <tr>
                                <td><span style="color:white;">.</span></td>
                            </tr>
                            <tr>
                                <td><b>สถานที่ส่งของ</b></td>
                                <td rowspan="2"><span t-field="o.delivery_address"/></td>
                            </tr>
                            <tr>
                                <td><span style="color:white;">.</span></td>
                            </tr>
                            <tr>
                                <td><b>ชื่อผู้ติดต่อ</b></td>
                                <td rowspan="2">
                                    <t t-if="o.partner_id.contact">
                                        <span t-field="o.partner_id.contact"/>
                                    </t>
                                    <t t-else="">
                                        <span>-</span>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td><span style="color:white;">.</span></td>
                            </tr>
                            <tr>
                                <td><b>เบอร์ติดต่อ</b></td>
                                <td rowspan="2">
                                    <t t-if="o.partner_id.contact_mobile">
                                        <span t-field="o.partner_id.contact_mobile"/>
                                    </t>
                                    <t t-else="">
                                        <span>-</span>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td><span style="color:white;">.</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- table class number_po -->
            <table class="number_po">
                <tr>
                    <thead>
                        <th>ใบสั่งซื้อเลขที่/สัญญาเลขที่</th>
                        <th>ใบรับเงินมัดจำเลขที่</th>
                        <th>เครดิต</th>
                        <th>วันครบกำหนด</th>
                    </thead>
                </tr>
                <tr>
                    <tbody style="font-size:12px;">
                        <td>
                            <t t-if="o.po_no">
                                <span t-field="o.po_no"/>
                            </t>
                            <t t-els="">
                                <span style="color:white;">.</span>
                            </t>
                        </td>
                        <td>
                            <t t-if="o.advance_no">
                                <span t-field="o.advance_no"/>
                            </t>
                            <t t-els="">
                                <span style="color:white;">.</span>
                            </t>
                        </td>
                        <td>
                            <t t-if="o.invoice_payment_term_id">
                                <span t-field="o.invoice_payment_term_id.name"/>
                            </t>
                            <t t-else="">
                                <span style="color:white;">.</span>
                            </t>
                        </td>
                        <td>
                            <t t-if="o.invoice_date_due">
                                <span t-esc="o.get_formatted_date(o.invoice_date_due)"/>
                            </t>
                            <t t-else="">
                                <span style="color:white;">.</span>
                            </t>
                        </td>
                    </tbody>
                </tr>
            </table>

        </div>

        <!-- ส่วนกลาง -->
        <div class="article" style="font-size:14px;">

            <t t-set="lines_per_page" t-value="18"/> <!-- จำนวนบรรทัดต่อหน้า -->
            <t t-set="count" t-value="0"/> <!-- เก็บลำดับของรายการ -->

            <!-- colum head -->
            <div class="row" style="width:100%; margin-left:0px; border:1px solid;">
                <div style="text-align:center; width:40px; min-width:40px; max-width:40px; border-right:1px solid;">
                    <b>ลำดับ</b>
                </div>
                <div style="text-align:center; width:150px; min-width:150px; max-width:150px; border-right:1px solid;">
                    <b>รหัสสินค้า</b>
                </div>
                <div style="text-align:center; width:245px; min-width:245px; max-width:245px; border-right:1px solid;">
                    <b>รายการ</b>
                </div>
                <div style="text-align:center; width:84px; min-width:84px; max-width:84px; border-right:1px solid;">
                    <b>จำนวน</b>
                </div>
                <div style="text-align:center; width:80px; min-width:80px; max-width:80px; border-right:1px solid;">
                    <b>หน่วย</b>
                </div>
                <div style="text-align:center; width:100px; min-width:100px; max-width:100px; border-right:1px solid;">
                    <b>ราคา/หน่วย</b>
                </div>
                <div style="text-align:center; width:70px; min-width:70px; max-width:70px; border-right:1px solid;">
                    <b>ส่วนลด</b>
                </div>
                <div style="text-align:center; width:101px; min-width:101px; max-width:101px;">
                    <b>จำนวนเงิน</b>
                </div>
            </div>

            <t t-if="o.tax_inv">

                <!-- colum lines -->
                <t t-set="total_lines" t-value="0"/> <!-- เก็บจำนวนบรรทัดในหน้านั้นๆ -->
                <t t-set="lines_without_product" t-value="o.get_lines_without_product_id()" />

                <t t-foreach="lines_without_product" t-as="line">
                    <!-- ตั้งค่า number_lines ตามความยาวของชื่อสินค้าว่าประมาณกี่บรรทัด -->
                    <t t-if="len(line['name']) > 128">
                        <t t-set="number_lines" t-value="5"/>
                    </t>
                    <t t-elif="len(line['name']) > 96">
                        <t t-set="number_lines" t-value="4"/>
                    </t>
                    <t t-elif="len(line['name']) > 64">
                        <t t-set="number_lines" t-value="3"/>
                    </t>
                    <t t-elif="len(line['name']) > 32">
                        <t t-set="number_lines" t-value="2"/>
                    </t>
                    <t t-else="">
                        <t t-set="number_lines" t-value="1"/>
                    </t>

                    <t t-set="total_lines" t-value="total_lines + number_lines"/>

                    <t t-set="count" t-value="count + 1"/>
                    <!-- tax invoice lines -->
                    <div class="row" style="width:100%; margin-left:0px;">
                        <div style="text-align:center; width:40px; min-width:40px; max-width:40px;">
                            <span t-esc="count"/>
                        </div>
                        <div style="text-align:left; width:150px; min-width:150px; max-width:150px;">
                            <!-- ส่วนของรหัสสินค้า -->
                        </div>
                        <div style="text-align:left; width:245px; min-width:245px; max-width:245px;">
                            <span t-esc="line['name']"/>
                        </div>
                        <div style="text-align:right; width:84px; min-width:84px; max-width:84px;">
                            <span t-esc="'{0:,.2f}'.format(line['quantity'])"/>
                        </div>
                        <div style="text-align:right; width:80px; min-width:80px; max-width:80px;">
                            <span t-esc="line['uom']"/>
                        </div>
                        <div style="text-align:right; width:100px; min-width:100px; max-width:100px;">
                            <span t-esc="'{0:,.2f}'.format(line['price_unit'])"/>
                        </div>
                        <div style="text-align:right; width:70px; min-width:70px; max-width:70px;">
                            <!-- ช่องส่วนลด -->
                        </div>
                        <div style="text-align:right; width:101px; min-width:101px; max-width:101px;">
                            <span t-esc="'{0:,.2f}'.format(line['price_subtotal'])"/>
                        </div>
                    </div>

                </t>

                <t t-set="number" t-value="lines_per_page - total_lines"/>
                <t t-foreach="range(number)" t-as="i">
                    <div>
                        <span style="color:white;">.</span>
                    </div>
                </t>

                <!-- ส่วนสรุปยอด -->
                <div class="row" style="width:100%; margin-left:0px;">
                    <style>
                        /* ส่วนของ table */
                        table {
                            table-layout:fixed;
                        }

                        /* ส่วนของ body */
                        table td {
                            border:1px solid;
                        }

                        /* หมายเหตุ */
                        table tr:nth-child(1) td:nth-child(1) {
                            text-align:left;
                            padding-left:4px;
                            padding-top: 4px;
                            width:520px;
                            min-width: 520px;
                            max-width: 520px;
                        }

                        /* รวมเงิน */
                        table tr:nth-child(1) td:nth-child(2) {
                            text-align:left;
                            padding-left:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                            width:180px;
                            min-width: 180px;
                            max-width: 180px;
                        }

                        /* value รวมเงิน */
                        table tr:nth-child(1) td:nth-child(3) {
                            text-align:right;
                            padding-right:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                            width:170px;
                            min-width: 170px;
                            max-width: 170px;
                        }

                        /* ภาษีมูลค่าเพิ่ม */
                        table tr:nth-child(2) td:nth-child(1) {
                            text-align:left;
                            padding-left:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                        }

                        /* value ภาษีมูลค่าเพิ่ม */
                        table tr:nth-child(2) td:nth-child(2) {
                            text-align:right;
                            padding-right:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                        }

                        /* จำนวนเงินทั้งสิ้น */
                        table tr:nth-child(3) td:nth-child(1) {
                            text-align:left;
                            padding-left:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                        }

                        /* value จำนวนเงินทั้งสิ้น */
                        table tr:nth-child(3) td:nth-child(2) {
                            text-align:right;
                            padding-right:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                        }

                        /* text amount */
                        table tr:nth-child(6) td:nth-child(1) {
                            text-align:center;
                            padding-top:4px;
                            padding-bottom: 4px;
                        }

                        table tr:nth-child(7) td:nth-child(1) {
                            text-align: left;
                            padding-top: 4px;
                            padding-bottom: 4px;
                            padding-left: 4px;
                        }
                    </style>
                    <table >
                        <tbody>
                            <tr>
                                <td rowspan="5">
                                    <span><b>หมายเหตุ:</b></span>
                                    <span t-field="o.narration"/>
                                </td>
                                <td>
                                    <span><b>รวมเงิน</b></span>
                                </td>
                                <td>
                                    <span t-esc="'{0:,.2f}'.format(o.amount_untaxed)"/>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <span><b>ภาษีมูลค่าเพิ่ม 7%</b></span>
                                </td>
                                <td>
                                    <span t-esc="'{0:,.2f}'.format(o.amount_tax)"/>
                                </td>
                            </tr>
                            <tr>
                                <td rowspan="4">
                                    <span><b>จำนวนเงินทั้งสิ้น</b></span>
                                </td>
                                <td rowspan="4">
                                    <span t-esc="'{0:,.2f}'.format(o.amount_total)"/>
                                </td>
                            </tr>
                            <tr></tr>
                            <tr></tr>
                            <tr>
                                <td>
                                    <span>
                                        <t t-set="amount_to_text" t-value="o.currency_id.with_context({'lang': 'th_TH'}).amount_to_text(o.amount_total)" />
                                        <t t-set="amount_split" t-value="amount_to_text.split(' ')" />
                                        <t t-if="len(amount_split) &gt; 2">
                                            <t t-set="amount_text_thai" t-value="''.join([amount_split[0], 'บาท', amount_split[3], 'สตางค์'])" />
                                        </t>
                                        <t t-else="">
                                            <t t-set="amount_text_thai" t-value="''.join([amount_split[0]])" />
                                        </t>
                                        <span style="margin-left:3px;" t-esc=" ''+ amount_text_thai +'' " />
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <span>
                                        สินค้าตามใบส่งของนี้ แม้จะได้รับส่งมอบแก่ผู้ซื้อแล้วยังคงเป็นทรัพย์สินของผู้ขาย จนกว่าผู้ซื้อได้ชำระเงินเสร็จเรียบร้อยแล้ว
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </t>

            <t t-else="">

                <t t-set="total" t-value="0"/> <!-- ยอด price_subtotal รวมทุกรายการ -->
                <t t-set="total_lines" t-value="0"/> <!-- เก็บจำนวนบรรทัดในหน้านั้นๆ -->

                <!-- tax invoice lines -->
                <t t-foreach="o.invoice_line_ids" t-as="line">
                    <t t-if="line.product_id">
                        <t t-set="total" t-value="total + line.price_subtotal"/>
                        <t t-set="count" t-value="count + 1"/>
                    
                        <!-- ตั้งค่า number_lines ตามความยาวของชื่อสินค้าว่าประมาณกี่บรรทัด -->
                        <t t-if="len(line.product_id.default_code) > 128">
                            <t t-set="number_lines" t-value="5"/>
                        </t>
                        <t t-elif="len(line.product_id.default_code) > 96">
                            <t t-set="number_lines" t-value="4"/>
                        </t>
                        <t t-elif="len(line.product_id.default_code) > 64">
                            <t t-set="number_lines" t-value="3"/>
                        </t>
                        <t t-elif="len(line.product_id.default_code) > 32">
                            <t t-set="number_lines" t-value="2"/>
                        </t>
                        <t t-else="">
                            <t t-set="number_lines" t-value="1"/>
                        </t>

                        <t t-set="total_lines" t-value="total_lines + number_lines"/>

                        <!-- เช็คว่า total_lines เกิน 18 แล้วหรือยัง -->
                        <t t-if="total_lines > lines_per_page">
                            <div style="page-break-after: always; height:100px;"></div>
                            <t t-set="total_lines" t-value="0"/>
                            <t t-set="total_lines" t-value="total_lines + number_lines"/>

                            <!-- colum head -->
                            <div class="row" style="width:100%; margin-left:0px; border:1px solid;">
                                <div style="text-align:center; width:40px; min-width:40px; max-width:40px; border-right:1px solid;">
                                    <b>ลำดับ</b>
                                </div>
                                <div style="text-align:center; width:150px; min-width:150px; max-width:150px; border-right:1px solid;">
                                    <b>รหัสสินค้า</b>
                                </div>
                                <div style="text-align:center; width:245px; min-width:245px; max-width:245px; border-right:1px solid;">
                                    <b>รายการ</b>
                                </div>
                                <div style="text-align:center; width:84px; min-width:84px; max-width:84px; border-right:1px solid;">
                                    <b>จำนวน</b>
                                </div>
                                <div style="text-align:center; width:80px; min-width:80px; max-width:80px; border-right:1px solid;">
                                    <b>หน่วย</b>
                                </div>
                                <div style="text-align:center; width:100px; min-width:100px; max-width:100px; border-right:1px solid;">
                                    <b>ราคา/หน่วย</b>
                                </div>
                                <div style="text-align:center; width:70px; min-width:70px; max-width:70px; border-right:1px solid;">
                                    <b>ส่วนลด</b>
                                </div>
                                <div style="text-align:center; width:101px; min-width:101px; max-width:101px;">
                                    <b>จำนวนเงิน</b>
                                </div>
                            </div>

                            <!-- colum lines -->
                            <div class="row" style="width:100%; margin-left:0px;">
                                <div style="text-align:center; width:40px; min-width:40px; max-width:40px;">
                                    <span t-esc="count"/>
                                </div>
                                <div style="text-align:left; width:150px; min-width:150px; max-width:150px;">
                                    <t t-if="line.product_id">
                                        <span t-esc="line.product_id.name"/>
                                    </t>
                                    <t t-else="">
                                        <span t-esc="line.name"/>
                                    </t>
                                </div>
                                <div style="text-align:left; width:245px; min-width:245px; max-width:245px;">
                                    <t t-if="line.product_id">
                                        <span t-esc="line.product_id.default_code"/>
                                    </t>
                                </div>
                                <div style="text-align:right; width:84px; min-width:84px; max-width:84px;">
                                    <span t-esc="'{0:,.2f}'.format(line.quantity)"/>
                                </div>
                                <div style="text-align:right; width:80px; min-width:80px; max-width:80px;">
                                    <span t-esc="line.product_uom_id.name"/>
                                </div>
                                <div style="text-align:right; width:100px; min-width:100px; max-width:100px;">
                                    <span t-esc="'{0:,.2f}'.format(line.price_unit)"/>
                                </div>
                                <div style="text-align:right; width:70px; min-width:70px; max-width:70px;">
                                    
                                </div>
                                <div style="text-align:right; width:101px; min-width:101px; max-width:101px;">
                                    <span t-esc="'{0:,.2f}'.format(line.price_subtotal)"/>
                                </div>
                            </div>
                        </t>

                        <t t-else="">
                            <!-- colum lines -->
                            <div class="row" style="width:100%; margin-left:0px;">
                                <div style="text-align:center; width:40px; min-width:40px; max-width:40px;">
                                    <span t-esc="count"/>
                                </div>
                                <div style="text-align:center; width:150px; min-width:150px; max-width:150px;">
                                    <t t-if="line.product_id">
                                        <span t-esc="line.product_id.name"/>
                                    </t>
                                    <t t-else="">
                                        <span t-esc="line.name"/>
                                    </t>
                                </div>
                                <div style="text-align:left; width:245px; min-width:245px; max-width:245px;">
                                    <t t-if="line.product_id">
                                        <span t-esc="line.product_id.default_code"/>
                                    </t>
                                </div>
                                <div style="text-align:right; width:84px; min-width:84px; max-width:84px;">
                                    <span t-esc="'{0:,.2f}'.format(line.quantity)"/>
                                </div>
                                <div style="text-align:right; width:80px; min-width:80px; max-width:80px;">
                                    <span t-esc="line.product_uom_id.name"/>
                                </div>
                                <div style="text-align:right; width:100px; min-width:100px; max-width:100px;">
                                    <span t-esc="'{0:,.2f}'.format(line.price_unit)"/>
                                </div>
                                <div style="text-align:right; width:70px; min-width:70px; max-width:70px;">
                                    
                                </div>
                                <div style="text-align:right; width:101px; min-width:101px; max-width:101px;">
                                    <span t-esc="'{0:,.2f}'.format(line.price_subtotal)"/>
                                </div>
                            </div>
                        </t>
                    </t>
                </t>

                <t t-set="number" t-value="lines_per_page - total_lines"/>
                <t t-foreach="range(number)" t-as="i">
                    <div>
                        <span style="color:white;">.</span>
                    </div>
                </t>

                <!-- ส่วนสรุปยอด -->
                <div class="row" style="width:100%; margin-left:0px;">
                    <style>
                        /* ส่วนของ table */
                        table {
                            table-layout:fixed;
                        }

                        /* ส่วนของ body */
                        table td {
                            border:1px solid;
                        }

                        /* หมายเหตุ */
                        table tr:nth-child(1) td:nth-child(1) {
                            text-align:left;
                            padding-left:4px;
                            padding-top: 4px;
                            width:520px;
                            min-width: 520px;
                            max-width: 520px;
                        }

                        /* รวมเงิน */
                        table tr:nth-child(1) td:nth-child(2) {
                            text-align:left;
                            padding-left:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                            width:180px;
                            min-width: 180px;
                            max-width: 180px;
                        }

                        /* value รวมเงิน */
                        table tr:nth-child(1) td:nth-child(3) {
                            text-align:right;
                            padding-right:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                            width:170px;
                            min-width: 170px;
                            max-width: 170px;
                        }

                        /* ภาษีมูลค่าเพิ่ม */
                        table tr:nth-child(2) td:nth-child(1) {
                            text-align:left;
                            padding-left:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                        }

                        /* value ภาษีมูลค่าเพิ่ม */
                        table tr:nth-child(2) td:nth-child(2) {
                            text-align:right;
                            padding-right:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                        }

                        /* จำนวนเงินทั้งสิ้น */
                        table tr:nth-child(3) td:nth-child(1) {
                            text-align:left;
                            padding-left:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                        }

                        /* value จำนวนเงินทั้งสิ้น */
                        table tr:nth-child(3) td:nth-child(2) {
                            text-align:right;
                            padding-right:4px;
                            padding-top: 4px;
                            padding-bottom: 4px;
                        }

                        /* text amount */
                        table tr:nth-child(6) td:nth-child(1) {
                            text-align:center;
                            padding-top:4px;
                            padding-bottom: 4px;
                        }

                        table tr:nth-child(7) td:nth-child(1) {
                            text-align: left;
                            padding-top: 4px;
                            padding-bottom: 4px;
                            padding-left: 4px;
                        }
                    </style>
                    <table >
                        <tbody>
                            <tr>
                                <td rowspan="5">
                                    <span><b>หมายเหตุ:</b></span>
                                    <span t-field="o.narration"/>
                                </td>
                                <td>
                                    <span><b>รวมเงิน</b></span>
                                </td>
                                <td>
                                    <span t-esc="'{0:,.2f}'.format(o.amount_untaxed)"/>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <span><b>ภาษีมูลค่าเพิ่ม 7%</b></span>
                                </td>
                                <td>
                                    <span t-esc="'{0:,.2f}'.format(o.amount_tax)"/>
                                </td>
                            </tr>
                            <tr>
                                <td rowspan="4">
                                    <span><b>จำนวนเงินทั้งสิ้น</b></span>
                                </td>
                                <td rowspan="4">
                                    <span t-esc="'{0:,.2f}'.format(o.amount_total)"/>
                                </td>
                            </tr>
                            <tr></tr>
                            <tr></tr>
                            <tr>
                                <td>
                                    <span>
                                        <t t-set="amount_to_text" t-value="o.currency_id.with_context({'lang': 'th_TH'}).amount_to_text(o.amount_total)" />
                                        <t t-set="amount_split" t-value="amount_to_text.split(' ')" />
                                        <t t-if="len(amount_split) &gt; 2">
                                            <t t-set="amount_text_thai" t-value="''.join([amount_split[0], 'บาท', amount_split[3], 'สตางค์'])" />
                                        </t>
                                        <t t-else="">
                                            <t t-set="amount_text_thai" t-value="''.join([amount_split[0]])" />
                                        </t>
                                        <span style="margin-left:3px;" t-esc=" ''+ amount_text_thai +'' " />
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <span>
                                        สินค้าตามใบส่งของนี้ แม้จะได้รับส่งมอบแก่ผู้ซื้อแล้วยังคงเป็นทรัพย์สินของผู้ขาย จนกว่าผู้ซื้อได้ชำระเงินเสร็จเรียบร้อยแล้ว
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
            </t>

        </div>

        <!-- ส่วนท้าย -->
        <div class="footer" style="font-size:14px;">

            <div class="row" style="margin-left:0px; margin-right:0px; margin-top:5px; ">
                <div class="col-4" style="border:1px solid;">
                    <p>
                        ได้รับสินค้าตามรายการข้างบนไว้ถูกต้องในสภาพเรียบร้อยแล้ว
                    </p>
                    <span style="margin-left:10px;">
                        ___________________________________________
                    </span>
                    <br/>
                    <span style="margin-left:15px;">
                        ลงนามและประทับตรา (ถ้ามี) ผู้รับของ
                    </span>
                    <br/>
                    <span style="margin-left:70px;">
                        วันที่ _____/_____/_____
                    </span>
                </div>
                <div class="col-4" style="border:1px solid; margin-left:4px;">
                    <p>
                        ในนาม บริษัท นวกิจอลูมินั่น แอนด์ กลาส (2009) จำกัด
                    </p>
                    <span style="margin-left:10px;">
                        ___________________________________________
                    </span>
                    <br/>
                    <span style="margin-left:65px;">
                        ผู้มีอำนาจลงนาม
                    </span>
                    <br/>
                    <span style="margin-left:70px;">
                        วันที่ _____/_____/_____   
                    </span>
                </div>
                <div class="col-4" style="border:1px solid; margin-left:4px; margin-right:0px; width:283px; padding-top:20px;">
                    <p style="margin-left:5px;">ผู้รับเอกสาร ______________________________</p>

                    <p style="margin-left:7px;">ผู้ตรวจสอบ ______________________________</p>

                    <p style="margin-left:25px;">ผู้ส่งของ ______________________________</p>
                </div>
            </div>

        </div>

    </template>


    <template id="report_tax_invoice_th_pdf">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="navakij_report.report_tax_invoice_version_th_custom" />
            </t>
        </t>
    </template>
</odoo>